# Story 5.5: Search Page Frontend

## Status
Draft

## Story
**As a** user,
**I want** a search page to generate leads for my client profiles,
**so that** I can discover potential customers matching my ideal customer profile.

## Acceptance Criteria
1. Search page displays at `/search` route
2. User can initiate search using active client profile context
3. Manual override panel allows specifying custom search parameters
4. Real-time progress shows sources being queried and leads found
5. Search can be cancelled mid-progress, returning partial results
6. Results display ranked leads with intent scores
7. Quality slider (0-1) controls speed vs quality trade-off

## Tasks / Subtasks

- [ ] **Task 1: Create Search Page Layout** (AC: 1, 7)
  - [ ] Create `apps/web/app/(dashboard)/search/page.tsx`
  - [ ] Add search header with active client context
  - [ ] Add quality slider component
  - [ ] Add "Start Search" button

- [ ] **Task 2: Create Manual Override Panel** (AC: 3)
  - [ ] Create collapsible manual override section
  - [ ] Add keyword input field
  - [ ] Add location filter
  - [ ] Add company size filter
  - [ ] Add budget range filter
  - [ ] Add "Supplement" vs "Replace" toggle

- [ ] **Task 3: Implement Search Progress** (AC: 4, 5)
  - [ ] Create search progress component
  - [ ] Display sources being queried (pending/success/failed)
  - [ ] Display leads found counter
  - [ ] Display overall percentage progress
  - [ ] Add cancel button during search

- [ ] **Task 4: Implement Results Display** (AC: 6)
  - [ ] Create lead result card component
  - [ ] Display name, company, email, phone
  - [ ] Display intent score with breakdown tooltip
  - [ ] Display source with link
  - [ ] Add CSV export button

- [ ] **Task 5: Create Search Store** (AC: 2, 4, 5)
  - [ ] Create `apps/web/stores/search-store.ts`
  - [ ] Manage search state (idle, searching, completed, cancelled)
  - [ ] Integrate with search API endpoint
  - [ ] Handle WebSocket for real-time updates (if available)

## Dev Notes

### Component Structure
```
apps/web/
├── app/(dashboard)/search/
│   └── page.tsx
├── components/search/
│   ├── search-header.tsx
│   ├── manual-override.tsx
│   ├── search-progress.tsx
│   ├── search-results.tsx
│   ├── lead-card.tsx
│   └── quality-slider.tsx
└── stores/
    └── search-store.ts
```

### API Endpoints
- POST `/v1/searches` - Start new search
- GET `/v1/searches/{id}` - Get search status/results
- DELETE `/v1/searches/{id}` - Cancel search
- WebSocket `/ws/searches/{id}` - Real-time progress (FR54)

### Manual Override Schema
```typescript
interface ManualOverride {
  mode: 'supplement' | 'replace';
  keywords?: string;
  location?: string;
  companySize?: 'solo' | 'small' | 'medium' | 'enterprise';
  budgetMin?: number;
  budgetMax?: number;
  industry?: string;
}
```

### References
- PRD FR33-FR37: Manual Search Mode
- PRD FR54: Real-time search progress via WebSocket
- PRD FR56: Search cancellation
- PRD FR30-FR32: Quality control slider

## Testing

### Verification
1. Navigate to /search and verify page loads
2. Start search and verify progress updates
3. Cancel search and verify partial results returned
4. Use manual override and verify parameters applied
5. Verify quality slider affects search behavior
6. Export results to CSV and verify format

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-01-18 | 0.1 | Initial story draft | Claude Opus 4.5 |

## Dev Agent Record

### Agent Model Used
(To be filled during implementation)

### Debug Log References
- N/A

### Completion Notes List
(To be filled during implementation)

### File List
**To Create:**
- apps/web/app/(dashboard)/search/page.tsx
- apps/web/components/search/search-header.tsx
- apps/web/components/search/manual-override.tsx
- apps/web/components/search/search-progress.tsx
- apps/web/components/search/search-results.tsx
- apps/web/components/search/lead-card.tsx
- apps/web/components/search/quality-slider.tsx
- apps/web/components/search/index.ts
- apps/web/stores/search-store.ts

**To Modify:**
- apps/web/app/(dashboard)/layout.tsx (ensure /search in nav)

## QA Results
(To be filled after implementation)
